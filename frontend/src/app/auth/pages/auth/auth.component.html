<div class="auth-page-container" #authContainer [ngClass]="'view-' + currentView">
  <div class="forms-wrapper">

    <!-- Login Form -->
    <div class="form-card login-card" [class.active]="currentView === 'login'">
      <mat-card>
        <mat-card-header>
          <mat-card-title>Iniciar Sesión</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <form #loginForm="ngForm" (ngSubmit)="onLoginSubmit()">
            <mat-form-field appearance="fill">
              <mat-label>Usuario</mat-label>
              <input matInput [(ngModel)]="loginUsername" name="username" required>
            </mat-form-field>
            <mat-form-field appearance="fill">
              <mat-label>Contraseña</mat-label>
              <input matInput type="password" [(ngModel)]="loginPassword" name="password" required>
            </mat-form-field>
            <button mat-raised-button color="primary" type="submit" [disabled]="!loginForm.valid">Entrar</button>
          </form>
          <p *ngIf="loginErrorMessage" class="error-message">{{ loginErrorMessage }}</p>
        </mat-card-content>
        <mat-card-actions>
          <a (click)="showRegister()">Registrar una cuenta</a>
          <a (click)="showRecover()">¿Olvidaste tu contraseña?</a>
        </mat-card-actions>
      </mat-card>
    </div>

    <!-- Registration Form -->
    <div class="form-card registration-card" [class.active]="currentView === 'register'">
      <mat-card>
        <mat-card-header>
          <mat-card-title>Registrar Nueva Cuenta</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <form [formGroup]="registrationForm" (ngSubmit)="onRegisterSubmit()">
            <mat-form-field appearance="fill">
              <mat-label>Nombre de Usuario</mat-label>
              <input matInput formControlName="username" required>
              <mat-error *ngIf="registrationForm.get('username')?.hasError('required') && registrationForm.get('username')?.touched">
                El nombre de usuario es requerido.
              </mat-error>
            </mat-form-field>
            <mat-form-field appearance="fill">
              <mat-label>Correo Electrónico</mat-label>
              <input matInput formControlName="email" type="email" required>
              <mat-error *ngIf="registrationForm.get('email')?.hasError('required') && registrationForm.get('email')?.touched">
                El correo electrónico es requerido.
              </mat-error>
              <mat-error *ngIf="registrationForm.get('email')?.hasError('email') && registrationForm.get('email')?.touched">
                Ingresa un correo electrónico válido.
              </mat-error>
            </mat-form-field>
            <mat-form-field appearance="fill">
              <mat-label>Contraseña</mat-label>
              <input matInput formControlName="password" type="password" required>
               <mat-error *ngIf="registrationForm.get('password')?.hasError('minlength') && registrationForm.get('password')?.touched">
                La contraseña debe tener al menos 8 caracteres.
              </mat-error>
            </mat-form-field>
            <mat-form-field appearance="fill">
              <mat-label>Confirmar Contraseña</mat-label>
              <input matInput formControlName="password2" type="password" required>
              <mat-error *ngIf="registrationForm.get('password2')?.hasError('mismatch') && registrationForm.get('password2')?.touched">
                Las contraseñas no coinciden.
              </mat-error>
            </mat-form-field>
            <button mat-raised-button color="primary" type="submit" [disabled]="!registrationForm.valid">Registrar</button>
          </form>
          <p *ngIf="registrationErrorMessage" class="error-message">{{ registrationErrorMessage }}</p>
          <p *ngIf="registrationSuccessMessage" class="success-message">{{ registrationSuccessMessage }}</p>
        </mat-card-content>
        <mat-card-actions>
          <a (click)="showLogin()">Volver a Iniciar Sesión</a>
        </mat-card-actions>
      </mat-card>
    </div>

    <!-- Password Recovery Form -->
    <div class="form-card recovery-card" [class.active]="currentView === 'recover'">
      <mat-card>
        <mat-card-header>
          <mat-card-title>Restablecer Contraseña</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <form [formGroup]="recoveryForm" (ngSubmit)="onRecoverSubmit()">
            <mat-form-field appearance="fill">
              <mat-label>Correo Electrónico</mat-label>
              <input matInput formControlName="email" type="email" required>
              <mat-error *ngIf="recoveryForm.get('email')?.hasError('required') && recoveryForm.get('email')?.touched">
                El correo electrónico es requerido.
              </mat-error>
              <mat-error *ngIf="recoveryForm.get('email')?.hasError('email') && recoveryForm.get('email')?.touched">
                Ingresa un correo electrónico válido.
              </mat-error>
            </mat-form-field>
            <button mat-raised-button color="primary" type="submit" [disabled]="!recoveryForm.valid">Restablecer</button>
          </form>
          <p *ngIf="recoveryErrorMessage" class="error-message">{{ recoveryErrorMessage }}</p>
          <p *ngIf="recoverySuccessMessage" class="success-message">{{ recoverySuccessMessage }}</p>
        </mat-card-content>
        <mat-card-actions>
          <a (click)="showLogin()">Volver a Iniciar Sesión</a>
        </mat-card-actions>
      </mat-card>
    </div>

  </div>
</div>